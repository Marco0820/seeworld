# Crepal.ai 全站自动化测试指南

## 概述

本项目使用 Playwright 对 https://crepal.ai 网站进行全面的自动化测试，涵盖功能测试、性能测试、可访问性测试等多个维度。

## 🎯 测试目标

作为高级产品经理，通过自动化测试来：
- **全面体验网站功能** - 模拟真实用户操作流程
- **验证用户体验** - 确保界面友好、交互流畅
- **监控性能表现** - 检测加载速度、响应时间
- **确保可访问性** - 验证无障碍访问支持
- **发现潜在问题** - 提前识别功能缺陷和优化点

## 📁 测试结构

```
tests/
├── utils/
│   └── test-helpers.ts          # 测试工具类和辅助函数
├── pages/
│   ├── homepage.spec.ts         # 首页功能测试
│   └── navigation.spec.ts       # 导航和页面跳转测试
├── functionality/
│   ├── forms.spec.ts            # 表单和交互功能测试
│   └── video-generation.spec.ts # 视频生成功能深度测试
├── accessibility/
│   └── a11y.spec.ts            # 可访问性和用户体验测试
├── performance/
│   └── performance.spec.ts      # 性能和优化测试
└── run-all-tests.ts            # 统一测试执行脚本
```

## 🚀 快速开始

### 1. 安装依赖
```bash
npm install
```

### 2. 运行测试

#### 完整测试套件
```bash
npm run test:crepal
```

#### 核心功能测试
```bash
npm run test:crepal:core
```

#### 扩展测试（性能、可访问性）
```bash
npm run test:crepal:extended
```

#### UI模式（可视化调试）
```bash
npm run test:crepal:ui
```

#### 调试模式
```bash
npm run test:crepal:debug
```

#### 查看测试报告
```bash
npm run test:crepal:report
```

## 📋 测试套件详解

### 1. 首页测试 (homepage.spec.ts)
- ✅ 页面基本加载验证
- ✅ 导航栏功能测试
- ✅ 主要内容区域检查
- ✅ 响应式设计验证
- ✅ 链接有效性测试
- ✅ 图片加载状态检查
- ✅ 性能指标监控
- ✅ 用户交互模拟

### 2. 导航测试 (navigation.spec.ts)
- ✅ 主要页面导航跳转
- ✅ 面包屑导航功能
- ✅ 页脚链接测试
- ✅ 搜索功能验证
- ✅ 移动端菜单测试
- ✅ 页面历史导航

### 3. 表单交互测试 (forms.spec.ts)
- ✅ 注册/登录表单测试
- ✅ 联系表单功能验证
- ✅ 视频生成表单测试
- ✅ 搜索和筛选功能
- ✅ 下拉菜单交互测试
- ✅ 按钮交互验证
- ✅ 模态框和弹窗测试

### 4. 视频生成功能测试 (video-generation.spec.ts)
- ✅ 完整工作流程测试
- ✅ 文本输入功能验证
- ✅ 模型选择测试
- ✅ 参数设置功能
- ✅ 预览功能测试
- ✅ 历史记录管理
- ✅ 配额和限制检查

### 5. 可访问性测试 (a11y.spec.ts)
- ✅ 键盘导航测试
- ✅ ARIA标签验证
- ✅ 语义化标签检查
- ✅ 颜色对比度测试
- ✅ 屏幕阅读器友好性
- ✅ 移动端可访问性
- ✅ 错误处理和反馈
- ✅ 国际化支持

### 6. 性能测试 (performance.spec.ts)
- ✅ 页面加载性能监控
- ✅ 资源加载优化检查
- ✅ Core Web Vitals 测试
- ✅ 内存使用监控
- ✅ 网络连接性能
- ✅ 缓存策略验证
- ✅ JavaScript性能分析

## 🛠️ 测试工具类 (test-helpers.ts)

### 主要功能：
- **页面加载等待** - `waitForPageLoad()`
- **自动截图记录** - `takeScreenshot(name)`
- **基本元素检查** - `checkBasicPageElements()`
- **响应式测试** - `checkResponsiveDesign()`
- **链接有效性检查** - `checkLinks()`
- **表单元素分析** - `checkFormElements()`
- **图片加载验证** - `checkImages()`
- **用户交互模拟** - `simulateUserInteraction()`
- **性能指标收集** - `checkPerformance()`

## 📊 测试报告

### 自动生成内容：
1. **HTML可视化报告** - 详细的测试执行结果
2. **截图记录** - 关键步骤的页面截图
3. **性能数据** - 加载时间、Core Web Vitals等
4. **错误日志** - 详细的失败信息和堆栈跟踪
5. **JSON数据** - 结构化的测试结果数据

### 报告位置：
- `test-results/` - 测试结果和报告
- `test-results/screenshots/` - 测试截图
- `playwright-report/` - HTML格式报告

## 🎨 测试策略

### 核心测试原则：
1. **用户视角** - 从真实用户使用场景出发
2. **全面覆盖** - 涵盖所有主要功能和页面
3. **性能导向** - 重点关注用户体验指标
4. **可维护性** - 模块化设计，易于扩展
5. **非破坏性** - 避免创建测试数据或触发实际操作

### 测试分类：
- **核心测试** - 基本功能，必须通过
- **扩展测试** - 性能和可访问性，建议通过
- **回归测试** - 确保新功能不影响现有功能

## 🔧 配置说明

### playwright.config.ts 主要配置：
- **多浏览器支持** - Chrome、Firefox、Safari、移动端
- **并行执行** - 提高测试效率
- **失败重试** - 提高测试稳定性
- **截图和录像** - 失败时自动记录
- **超时设置** - 合理的等待时间

### 环境变量：
- `CI` - CI环境下的特殊配置
- `DEBUG` - 调试模式开关

## 📈 最佳实践

### 1. 测试编写：
- 使用描述性的测试名称
- 添加详细的console.log输出
- 合理使用等待和超时
- 避免硬编码的选择器

### 2. 维护建议：
- 定期更新选择器
- 监控测试执行时间
- 及时修复不稳定的测试
- 保持测试用例的独立性

### 3. 调试技巧：
- 使用 `--debug` 模式逐步执行
- 利用 `--ui` 模式可视化调试
- 查看失败截图和录像
- 分析详细的错误日志

## 🚨 注意事项

1. **测试环境** - 确保网络连接稳定
2. **数据安全** - 不使用真实的敏感数据
3. **频率控制** - 避免过于频繁的测试执行
4. **资源清理** - 及时清理测试产生的临时文件
5. **版本兼容** - 保持Playwright版本更新

## 📞 支持和反馈

如有问题或建议，请：
1. 查看测试报告中的详细错误信息
2. 使用调试模式进行问题定位
3. 检查网站是否有更新影响测试
4. 联系开发团队进行测试用例调整

---

**测试愉快！让我们一起确保 Crepal.ai 提供最佳的用户体验！** 🎉

